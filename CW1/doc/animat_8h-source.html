<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>BEAST - Bioinspired Evolutionary Agent Simulation Toolkit: animat.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>animat.h</h1><a href="animat_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00016 <span class="preprocessor">#ifndef _ANIMAT_H</span>
00017 <span class="preprocessor"></span><span class="preprocessor">#define _ANIMAT_H</span>
00018 <span class="preprocessor"></span>
00019 <span class="preprocessor">#include &lt;iostream&gt;</span>
00020 <span class="preprocessor">#include &lt;map&gt;</span>
00021 <span class="preprocessor">#include &lt;string&gt;</span>
00022 <span class="preprocessor">#include &lt;cmath&gt;</span>
00023 <span class="preprocessor">#include &lt;algorithm&gt;</span>
00024 
00025 <span class="preprocessor">#include "worldobject.h"</span>
00026 <span class="preprocessor">#include "<a class="code" href="sensorbase_8h.html">sensorbase.h</a>"</span>
00027 <span class="preprocessor">#include "trail.h"</span>
00028 <span class="preprocessor">#include "<a class="code" href="utilities_8h.html">utilities.h</a>"</span>
00029 
00030 <span class="keyword">namespace </span>BEAST { 
00031 
<a name="l00037"></a><a class="code" href="group__framework.html#a0">00037</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="group__framework.html#a0">ANIMAT_RADIUS</a> = 5.0;       
<a name="l00038"></a><a class="code" href="group__framework.html#a1">00038</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="group__framework.html#a1">ANIMAT_MAX_SPEED</a> = 100.0;  
<a name="l00039"></a><a class="code" href="group__framework.html#a2">00039</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="group__framework.html#a2">ANIMAT_MIN_SPEED</a> = -50.0;  
<a name="l00040"></a><a class="code" href="group__framework.html#a3">00040</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="group__framework.html#a3">ANIMAT_MAX_ROTATE</a> = TWOPI; 
<a name="l00041"></a><a class="code" href="group__framework.html#a4">00041</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="group__framework.html#a4">ANIMAT_DRAG</a> = 50.0;        
<a name="l00042"></a><a class="code" href="group__framework.html#a5">00042</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="group__framework.html#a5">ANIMAT_ACCEL</a> = 5000.0;     
<a name="l00043"></a><a class="code" href="group__framework.html#a6">00043</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="group__framework.html#a6">ANIMAT_TIMESTEP</a> = 0.05;    
<a name="l00044"></a><a class="code" href="group__framework.html#a7">00044</a> <span class="keyword">const</span> <span class="keywordtype">int</span>    <a class="code" href="group__framework.html#a7">ANIMAT_PARTS</a> = 4;          
00045 
<a name="l00047"></a><a class="code" href="group__framework.html#a20">00047</a> <span class="keyword">enum</span> <a class="code" href="group__framework.html#a20">AnimatPartType</a> {
00048     ANIMAT_BODY,
00049     ANIMAT_CENTRE,
00050     ANIMAT_ARROW,
00051     ANIMAT_WHEEL
00052 };
00053 
00054 <span class="comment">// Forward declarations for friend declarations</span>
00055 <span class="keyword">class </span>AnimatMonitor;
00056 <span class="keyword">class </span>SelfSensor;
00057 
<a name="l00070"></a><a class="code" href="classBEAST_1_1Animat.html">00070</a> <span class="keyword">class </span><a class="code" href="classBEAST_1_1Animat.html">Animat</a> : <span class="keyword">public</span> <a class="code" href="classBEAST_1_1WorldObject.html">WorldObject</a>
00071 {
00072 <span class="keyword">protected</span>:
<a name="l00074"></a><a class="code" href="classBEAST_1_1Animat.html#x0">00074</a>     <span class="keyword">typedef</span> std::map&lt;std::string, Sensor*&gt; <a class="code" href="classBEAST_1_1Animat.html#x0">SensorContainer</a>;
<a name="l00076"></a><a class="code" href="classBEAST_1_1Animat.html#x1">00076</a>     <span class="keyword">typedef</span> SensorContainer::iterator <a class="code" href="classBEAST_1_1Animat.html#x1">SensorIter</a>;
<a name="l00078"></a><a class="code" href="classBEAST_1_1Animat.html#x2">00078</a>     <span class="keyword">typedef</span> std::map&lt;std::string, float&gt; <a class="code" href="classBEAST_1_1Animat.html#x2">ControlContainer</a>;
<a name="l00080"></a><a class="code" href="classBEAST_1_1Animat.html#x3">00080</a>     <span class="keyword">typedef</span> ControlContainer::iterator <a class="code" href="classBEAST_1_1Animat.html#x3">ControlIter</a>;
00081 
<a name="l00082"></a><a class="code" href="classBEAST_1_1Animat.html#n0">00082</a>     <span class="keyword">friend</span> <span class="keyword">class </span>AnimatMonitor; 
<a name="l00083"></a><a class="code" href="classBEAST_1_1Animat.html#n1">00083</a>     <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classBEAST_1_1SelfSensor.html">SelfSensor</a>;        
00084 
00085 <span class="keyword">public</span>:
00086     <span class="comment">// Construction and destruction:</span>
00087     <a class="code" href="classBEAST_1_1Animat.html#a0">Animat</a>();
00088     <span class="keyword">virtual</span> <a class="code" href="classBEAST_1_1Animat.html#a1">~Animat</a>();
00089 
00090     <span class="comment">// Lifecycle methods:</span>
00091     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a class="code" href="classBEAST_1_1Animat.html#a2">Init</a>();
00092     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1Animat.html#a3">Add</a>(std::string name, <a class="code" href="classBEAST_1_1Sensor.html">Sensor</a>* s);
<a name="l00100"></a><a class="code" href="classBEAST_1_1Animat.html#a4">00100</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1Animat.html#a4">Share</a>(std::string name, <a class="code" href="classBEAST_1_1Sensor.html">Sensor</a>* s) { sensors[name] = s; }
00101 
00102     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a class="code" href="classBEAST_1_1Animat.html#a5">Update</a>();
<a name="l00106"></a><a class="code" href="classBEAST_1_1Animat.html#a6">00106</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a class="code" href="classBEAST_1_1Animat.html#a6">Control</a>(){}
00107     
00108     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a class="code" href="classBEAST_1_1Animat.html#a7">Interact</a>(Animat*);
00109     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a class="code" href="classBEAST_1_1Animat.html#a7">Interact</a>(WorldObject*);
00110     <span class="keyword">virtual</span> <span class="keywordtype">bool</span>    <a class="code" href="classBEAST_1_1Animat.html#a9">IsTouching</a>(<span class="keyword">const</span> WorldObject*)<span class="keyword">const</span>;
00111     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    OnCollision(WorldObject* r){}
00112 
00113     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1Animat.html#a11">SensorInteract</a>(WorldObject* other);
00114 
00115     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a class="code" href="classBEAST_1_1Animat.html#a12">Display</a>();
00116     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a class="code" href="classBEAST_1_1Animat.html#a13">Draw</a>();
00117 
00118     <span class="comment">// Accessors:</span>
00119     Vector2D        GetVelocity()<span class="keyword">const</span>          { <span class="keywordflow">return</span> velocity; }
00120     <span class="keywordtype">double</span>          GetMaxSpeed()<span class="keyword">const</span>          { <span class="keywordflow">return</span> maxSpeed; }
00121     <span class="keywordtype">double</span>          GetMinSpeed()<span class="keyword">const</span>          { <span class="keywordflow">return</span> minSpeed; }
00122     <span class="keywordtype">double</span>          GetMaxRotateSpeed()<span class="keyword">const</span>    { <span class="keywordflow">return</span> maxTurn; }
<a name="l00124"></a><a class="code" href="classBEAST_1_1Animat.html#e0">00124</a>     <span class="keyword">static</span> <span class="keywordtype">int</span>      <a class="code" href="classBEAST_1_1Animat.html#e0">GetNumAnimats</a>()             { <span class="keywordflow">return</span> numAnimats; }
00125     <span class="keywordtype">double</span>          GetTimeStep()<span class="keyword">const</span>          { <span class="keywordflow">return</span> timeStep; }
00126     <span class="keywordtype">double</span>          GetDistanceTravelled()<span class="keyword">const</span> { <span class="keywordflow">return</span> distanceTravelled; }
00127     <span class="keywordtype">double</span>          GetPowerUsed()<span class="keyword">const</span>         { <span class="keywordflow">return</span> powerUsed; }
00128 
00129     <span class="comment">// Mutators:</span>
<a name="l00131"></a><a class="code" href="classBEAST_1_1Animat.html#a21">00131</a> <span class="comment"></span>    <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1Animat.html#a21">SetStartLocation</a>(<span class="keyword">const</span> <a class="code" href="classBEAST_1_1Vector2D.html">Vector2D</a>&amp; l){ startLocation = l; }
00132     <span class="keywordtype">void</span>            SetStartOrientation(<span class="keywordtype">double</span> o){ startOrientation = o; }
00133     <span class="keyword">static</span> <span class="keywordtype">void</span>     SetTimeStep(<span class="keywordtype">double</span> t)       { timeStep = t; }
00134 
00135     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a class="code" href="classBEAST_1_1Animat.html#a23">Serialise</a>(std::ostream&amp;)<span class="keyword">const</span>;
00136     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a class="code" href="classBEAST_1_1Animat.html#a24">Unserialise</a>(std::istream&amp;);
00137 
00138     <span class="keywordtype">void</span>            SetCollisionPoint(<span class="keyword">const</span> Vector2D&amp; v)<span class="keyword">const</span>   { collisionPoint = v; }
00139     <span class="keywordtype">void</span>            SetCollisionNormal(<span class="keyword">const</span> Vector2D&amp; v)<span class="keyword">const</span>  { collisionNormal = v; }
00140 
00141     auto_property&lt;Vector2D, Vector2D&amp;&gt; Velocity;
00142     auto_property&lt;double&gt; MinSpeed;
00143     auto_property&lt;double&gt; MaxSpeed;
00144     auto_property&lt;double&gt; MaxTurn;
00145     <span class="comment">// TODO: read/write only properties</span>
00146     auto_property&lt;double, double, double&gt; DistanceTravelled;
00147     auto_property&lt;double, double, double&gt; PowerUsed;
00148 
00149 <span class="keyword">protected</span>:
<a name="l00151"></a><a class="code" href="classBEAST_1_1Animat.html#b0">00151</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1Animat.html#b0">SetVelocity</a>(<span class="keyword">const</span> <a class="code" href="classBEAST_1_1Vector2D.html">Vector2D</a>&amp; pv) { velocity = pv; }
<a name="l00153"></a><a class="code" href="classBEAST_1_1Animat.html#b1">00153</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1Animat.html#b1">SetVelocityX</a>(<span class="keywordtype">double</span> x)      { velocity.<a class="code" href="classBEAST_1_1Vector2D.html#o0">x</a> = x; }
<a name="l00155"></a><a class="code" href="classBEAST_1_1Animat.html#b2">00155</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1Animat.html#b2">SetVelocityY</a>(<span class="keywordtype">double</span> y)      { velocity.<a class="code" href="classBEAST_1_1Vector2D.html#o1">y</a> = y; }
<a name="l00157"></a><a class="code" href="classBEAST_1_1Animat.html#b3">00157</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1Animat.html#b3">AddVelocity</a>(<span class="keyword">const</span> <a class="code" href="classBEAST_1_1Vector2D.html">Vector2D</a>&amp; v){ velocity = v; }
00158 
<a name="l00160"></a><a class="code" href="classBEAST_1_1Animat.html#b4">00160</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1Animat.html#b4">SetMaxSpeed</a>(<span class="keywordtype">double</span> s)       { maxSpeed = s; }
<a name="l00162"></a><a class="code" href="classBEAST_1_1Animat.html#b5">00162</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1Animat.html#b5">SetMinSpeed</a>(<span class="keywordtype">double</span> s)       { minSpeed = s; }
00163 
00165     <span class="keyword">inline</span> <span class="keywordtype">void</span>     <a class="code" href="group__framework.html#a23">SetColour</a>(AnimatPartType, <span class="keyword">const</span> <span class="keywordtype">float</span>*);
00167     <span class="keyword">inline</span> <span class="keywordtype">void</span>     <a class="code" href="group__framework.html#a23">SetColour</a>(AnimatPartType, <span class="keywordtype">float</span>, <span class="keywordtype">float</span>, <span class="keywordtype">float</span>, <span class="keywordtype">float</span> a = 1.0f);
00168 
00169     <span class="keyword">const</span> <a class="code" href="classBEAST_1_1Animat.html#x0">SensorContainer</a>&amp; GetSensors()<span class="keyword">const</span>    { <span class="keywordflow">return</span> sensors; }
00170     <a class="code" href="classBEAST_1_1Animat.html#x0">SensorContainer</a>&amp; GetSensors()               { <span class="keywordflow">return</span> sensors; }
00171     auto_indexed_pointer_property&lt;SensorContainer, const SensorContainer&amp;, void&gt; Sensors;
00172     <span class="keyword">const</span> <a class="code" href="classBEAST_1_1Animat.html#x2">ControlContainer</a>&amp; GetControls()<span class="keyword">const</span>  { <span class="keywordflow">return</span> controls; }
00173     <a class="code" href="classBEAST_1_1Animat.html#x2">ControlContainer</a>&amp; GetControls()             { <span class="keywordflow">return</span> controls; }
00174     auto_indexed_property&lt;ControlContainer, const ControlContainer&amp;, void&gt; Controls;
00175 
00176 <span class="keyword">private</span>:
00183     <a class="code" href="classBEAST_1_1Animat.html#x0">SensorContainer</a> sensors;
00189     <a class="code" href="classBEAST_1_1Animat.html#x2">ControlContainer</a> controls;
00190 
00191     Vector2D        velocity;       
00192     <span class="keywordtype">double</span>          minSpeed,       
00193                     maxSpeed,       
00194                     maxTurn;        
00195 
00196     GLfloat         colours[4][4];  
00197 
00198     Vector2D        startLocation;  
00199     <span class="keywordtype">double</span>          startOrientation;
00200             
00201     <span class="keywordtype">double</span>          distanceTravelled,
00202                     powerUsed;      
00203     
00204     Trail           trail;          
00205 
00206     <span class="keyword">mutable</span> Vector2D collisionPoint;
00207     <span class="keyword">mutable</span> Vector2D collisionNormal;
00208 
00209     <span class="keyword">static</span> <span class="keywordtype">double</span>   timeStep;       
00210 
00211     <span class="keyword">static</span> <span class="keywordtype">int</span>      numAnimats;     
00212 };
00213 
<a name="l00217"></a><a class="code" href="classBEAST_1_1Animat.html#a23">00217</a> <span class="keywordtype">void</span> Animat::SetColour(AnimatPartType part, <span class="keyword">const</span> <span class="keywordtype">float</span>* col)
00218 {
00219     <a class="code" href="group__framework.html#a23">SetColour</a>(part, col[0], col[1], col[2], col[3]);
00220 }
00221 
<a name="l00222"></a><a class="code" href="classBEAST_1_1Animat.html#a24">00222</a> <span class="keywordtype">void</span> Animat::SetColour(AnimatPartType part, <span class="keywordtype">float</span> r, <span class="keywordtype">float</span> g, <span class="keywordtype">float</span> b, <span class="keywordtype">float</span> a)
00223 {
00224     <span class="keywordflow">if</span> (part &gt; <a class="code" href="group__framework.html#a7">ANIMAT_PARTS</a>) <span class="keywordflow">return</span>;
00225 
00226     colours[part][0] = r;
00227     colours[part][1] = g;
00228     colours[part][2] = b;
00229     colours[part][3] = a;
00230 }
00231 
00236 }
00237 
00238 <span class="preprocessor">#endif</span>
00239 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sun Feb 1 21:25:33 2004 for BEAST - Bioinspired Evolutionary Agent Simulation Toolkit by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.2 </small></address>
</body>
</html>
