<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>BEAST - Bioinspired Evolutionary Agent Simulation Toolkit: Bacteria example source code</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1><a name="bacteriacode">Bacteria example source code</a>
</h1><div class="fragment"><pre><span class="comment">// Vim users: for increased viewing pleasure :set ts=4</span>

<span class="preprocessor">#include "wxsimenv.h"</span>
<span class="preprocessor">#include "<a class="code" href="simulation_8h.html">simulation.h</a>"</span>
<span class="preprocessor">#include "<a class="code" href="bacteria_8h.html">bacteria.h</a>"</span>

<span class="keyword">using</span> <span class="keyword">namespace </span>std;
<span class="keyword">using</span> <span class="keyword">namespace </span>BEAST;

<span class="keyword">class </span>TestBacterium : <span class="keyword">public</span> Bacterium
{
<span class="keyword">public</span>:
    TestBacterium() {
        <span class="comment">// These variables should remain constant for the whole simulation.</span>
        <span class="comment">// They represent universal constraints within which the bacteria must</span>
        <span class="comment">// survive. You are free to alter them, but consider each time how it</span>
        <span class="comment">// affects the realism of the simulation. Note that for our purposes,</span>
        <span class="comment">// the most realistic values will not necessarily give the best</span>
        <span class="comment">// results, and also that the values below are neither realistic nor</span>
        <span class="comment">// effective.</span>
        SetReproductionCost(0.4);   <span class="comment">// Amount of energy lost in reproduction</span>
        SetEnergyRate(0.005);       <span class="comment">// Rate of energy use (* speed)</span>
        SetSporeEnergyRate(0.01);   <span class="comment">// Energy used whether moving or not</span>
        SetAttractantCost(0.01);    <span class="comment">// Cost to release one unit of attractant</span>
        SetRepellentCost(0.01);     <span class="comment">// Cost to release one unit of repellent</span>
        SetDeathThreshold(0.0);     <span class="comment">// Minimum energy before bacterium dies</span>

        <span class="comment">// These variables might change as a result of a genetic algorithm, or</span>
        <span class="comment">// your own experimentation. In most cases, an effect can be switched</span>
        <span class="comment">// off by setting the relevant variable to 0.0.</span>
        SetReproductionThreshold(10.0); <span class="comment">// The amount of energy needed before</span>
                                        <span class="comment">// the bacterium reproduces (divides)</span>
        SetSporulationThreshold(0.25);  <span class="comment">// Energy level at sporulation</span>
        SetConsumptionRate(0.1);    <span class="comment">// Maximum food consumed per timestep</span>
        SetAttractantRate(0.5);     <span class="comment">// Amount of attractant released/food unit</span>
        SetRepellentRate(4.0);      <span class="comment">// Rate of repellent/inverse of food</span>
        SetSwarmRadius(0.0);        <span class="comment">// Radius in which velocities are summed</span>
        SetSwarmInfluence(0.0);     <span class="comment">// Degree of influence of swarm velocity</span>
        SetGradientInfluence(1.0);  <span class="comment">// Degree of influence of all gradients</span>
        SetNutrientResponse(1.0);   <span class="comment">// Relative change in direction wrt</span>
        SetAttractantResponse(0.0); <span class="comment">// nutrient, attractant and repellent</span>
        SetRepellentResponse(0.0);  <span class="comment">// respectively</span>
        SetAttractantThreshold(0.5);<span class="comment">// Minimum food to trigger attractant</span>
        SetRepellentThreshold(0.5); <span class="comment">// Minimum food to trigger repellent</span>

        <span class="comment">// This decides the amount of energy bacteria start with. If you find</span>
        <span class="comment">// your bacteria dying as soon as the simulation starts, it might be</span>
        <span class="comment">// worth increasing this, but if their consumption rate does not allow</span>
        <span class="comment">// them to reach equilibrium with the amount of food available it will</span>
        <span class="comment">// usually be worth adjusting the above variables instead.</span>
        SetEnergy(1.0);

        <span class="comment">// The speed is always constant, and influences energy consumption.</span>
        SetSpeed(40.0);
    }

    <span class="keyword">virtual</span> ~TestBacterium() {}
};

<span class="comment">// Sets up a few bacteria which demonstrate their gradient-following ability.</span>
<span class="keyword">class </span>BacteriaGradientSim : <span class="keyword">public</span> Simulation
{
<span class="keyword">protected</span>:
    <span class="comment">// An object to help us put bacteria into the World.</span>
    Group&lt;TestBacterium&gt;    grpBacteria;
    <span class="comment">// An object to help us put distributions into the World.</span>
    Group&lt;WorldObject&gt;      grpWorld;
    <span class="comment">// Pointers to Distributions, so we can keep track of them for the</span>
    <span class="comment">// duration of the simulation.</span>
    Distribution            *nutrient,
                            *trail;
<span class="keyword">public</span>:
    <span class="comment">// Constructor for our Simulation, in which Distributions are set up and</span>
    <span class="comment">// everything is put into the World.</span>
    BacteriaGradientSim():
    grpBacteria(30)
    {
        GetWorld().Toggle(DISPLAY_COLLISIONS);
        GetWorld().Toggle(DISPLAY_TRAILS);
        GetWorld().Toggle(DISPLAY_MONITOR);
        GetWorld().Toggle(DISPLAY_SENSORS);

        <span class="comment">// Set up a new 400 x 300 cell distribution.</span>
        nutrient = <span class="keyword">new</span> Distribution(400, 300, 1);
        nutrient-&gt;SetColour(1.0f, 1.0f, 1.0f); <span class="comment">// Set the colour to white.</span>
        nutrient-&gt;SetDiffusionSpeed(1); <span class="comment">// Make it diffuse once per timestep.</span>
        nutrient-&gt;Plot(0.5);            <span class="comment">// Set each point to 0.5.</span>
        <span class="comment">// Add a Gaussian blob to give the bacteria a gradient to climb.</span>
        nutrient-&gt;Filter(plus&lt;double&gt;(), Gaussian2D(200, 150, 30.0, 5000.0));
        nutrient-&gt;SetMaxConc(2.0);      <span class="comment">// Max display density is 3.</span>
        grpWorld.push_back(nutrient);   <span class="comment">// Put it into the grpWorld object.</span>

        <span class="comment">// Set up a new 800 x 600 distribution.</span>
        trail = <span class="keyword">new</span> Distribution(800, 600, 1);
        trail-&gt;SetColour(1.0f, 1.0f, 1.0f); <span class="comment">// Set the colour to orange.</span>
        trail-&gt;Plot(0.0);               <span class="comment">// Zero the distribution.</span>
        grpWorld.push_back(trail);      <span class="comment">// Put it into the grpWorld object.</span>

        Add(<span class="stringliteral">"Bacteria"</span>, grpBacteria);   <span class="comment">// Add the bacteria to the World.</span>
        Add(<span class="stringliteral">"Distributions"</span>, grpWorld); <span class="comment">// Add the distributions to the World.</span>

        <span class="comment">// Ignore the funny syntax; this just gives each Bacterium a pointer</span>
        <span class="comment">// to the nutrient and trail distributions.</span>
        grpBacteria.ForEach&lt;Distribution*&gt;(&amp;Bacterium::SetNutrientDist, nutrient);
        grpBacteria.ForEach&lt;Distribution*&gt;(&amp;Bacterium::SetTrailDist, trail);

        <span class="comment">// This makes the first 'assessment' go on for ever.</span>
        SetTimeSteps(-1);
    }

};

<span class="comment">// Now the bacteria will be adjusted to demonstrate swarming.</span>
<span class="keyword">class </span>BacteriaSwarmSim : <span class="keyword">public</span> BacteriaGradientSim
{
<span class="keyword">public</span>:
    BacteriaSwarmSim()
    {
        grpBacteria.ForEach&lt;<span class="keywordtype">double</span>&gt;(&amp;Bacterium::SetSwarmRadius, 20.0);
        grpBacteria.ForEach&lt;<span class="keywordtype">double</span>&gt;(&amp;Bacterium::SetSwarmInfluence, 0.5);
    }
};

<span class="keyword">class </span>BacteriaRepellentSim : <span class="keyword">public</span> BacteriaSwarmSim
{
<span class="keyword">protected</span>:
    <span class="comment">// A pointer to our repellent object.</span>
    Distribution *repellent;

<span class="keyword">public</span>:
    BacteriaRepellentSim()
    {
        <span class="comment">// Make and add a new, nasty pink distribution for repellent.</span>
        repellent = <span class="keyword">new</span> Distribution(400, 300, 1);
        repellent-&gt;SetColour(1.0f, 0.5f, 0.5f);
        repellent-&gt;SetDiffusionSpeed(2);
        repellent-&gt;Plot(0.0);
        repellent-&gt;SetMaxConc(1.5f);
        nutrient-&gt;SetDiffusionSpeed(1); <span class="comment">// Make it diffuse like nutrients.</span>
        grpWorld.push_back(repellent);

        <span class="comment">// Tell the bacteria about it.</span>
        grpBacteria.ForEach&lt;Distribution*&gt;(&amp;Bacterium::SetRepellentDist, repellent);

        <span class="comment">// Make them respond to repellents.</span>
        grpBacteria.ForEach&lt;<span class="keywordtype">double</span>&gt;(&amp;Bacterium::SetRepellentResponse, 0.5);

        <span class="comment">// Just for a laugh, plot some noise, keep the bacteria guessing...</span>
        nutrient-&gt;Filter(plus&lt;double&gt;(), GaussianNoise(0.0, 0.5));
    }
};

<span class="comment">// Now we have reproduction, repellent and swarming.</span>
<span class="keyword">class </span>BacteriaReproSim : <span class="keyword">public</span> BacteriaRepellentSim
{
<span class="keyword">public</span>:
    BacteriaReproSim()
    {
        <span class="comment">// In principle the bacteria could have reproduced in the previous</span>
        <span class="comment">// simulations, but the reproduction threshold was too high.</span>
        grpBacteria.ForEach&lt;<span class="keywordtype">double</span>&gt;(&amp;Bacterium::SetReproductionThreshold, 0.4);
        grpBacteria.ForEach&lt;<span class="keywordtype">double</span>&gt;(&amp;Bacterium::SetConsumptionRate, 0.2);

    }
};

<span class="comment">// Now we have reproduction, repellent and swarming.</span>
<span class="keyword">class </span>BacteriaAttractantSim : <span class="keyword">public</span> BacteriaReproSim
{
<span class="keyword">protected</span>:
    <span class="comment">// A pointer to our attractant object.</span>
    Distribution *attractant;

<span class="keyword">public</span>:
    BacteriaAttractantSim()
    {
        <span class="comment">// Make and add a new, slimey green distribution for attractant.</span>
        attractant = <span class="keyword">new</span> Distribution(400, 300, 1);
        attractant-&gt;SetColour(0.5f, 1.0f, 0.5f);
        attractant-&gt;SetDiffusionSpeed(2);
        attractant-&gt;Plot(0.0);
        attractant-&gt;SetMaxConc(1.5f);
        attractant-&gt;Update();
        grpWorld.push_back(attractant);

        <span class="comment">// Tell the bacteria about it.</span>
        grpBacteria.ForEach&lt;Distribution*&gt;(&amp;Bacterium::SetAttractantDist, attractant);

        <span class="comment">// Make them respond to attractants.</span>
        grpBacteria.ForEach&lt;<span class="keywordtype">double</span>&gt;(&amp;Bacterium::SetAttractantResponse, 0.5);
    }
};

<a class="code" href="beast_8h.html#a0">BEGIN_SIMULATION_TABLE</a>
    <a class="code" href="beast_8h.html#a1">ADD_SIMULATION</a>(<span class="stringliteral">"BacteriaGradient"</span>, BacteriaGradientSim)
    <a class="code" href="beast_8h.html#a1">ADD_SIMULATION</a>(<span class="stringliteral">"BacteriaSwarm"</span>, BacteriaSwarmSim)
    <a class="code" href="beast_8h.html#a1">ADD_SIMULATION</a>(<span class="stringliteral">"BacteriaRepellent"</span>, BacteriaRepellentSim)
    <a class="code" href="beast_8h.html#a1">ADD_SIMULATION</a>(<span class="stringliteral">"BacteriaRepro"</span>, BacteriaReproSim)
    <a class="code" href="beast_8h.html#a1">ADD_SIMULATION</a>(<span class="stringliteral">"BacteriaAttractant"</span>, BacteriaAttractantSim)
<a class="code" href="beast_8h.html#a2">END_SIMULATION_TABLE</a>
</pre></div> <hr size="1"><address style="align: right;"><small>Generated on Sun Feb 1 21:26:34 2004 for BEAST - Bioinspired Evolutionary Agent Simulation Toolkit by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.2 </small></address>
</body>
</html>
