<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>BEAST - Bioinspired Evolutionary Agent Simulation Toolkit: geneticalgorithm.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>geneticalgorithm.h</h1><a href="geneticalgorithm_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00006 <span class="preprocessor">#ifndef _GENETIC_ALGORITHM_H_</span>
00007 <span class="preprocessor"></span><span class="preprocessor">#define _GENETIC_ALGORITHM_H_</span>
00008 <span class="preprocessor"></span>
00009 <span class="preprocessor">#include &lt;vector&gt;</span>
00010 <span class="preprocessor">#include &lt;map&gt;</span>
00011 <span class="preprocessor">#include &lt;algorithm&gt;</span>
00012 <span class="preprocessor">#include &lt;numeric&gt;</span>
00013 <span class="preprocessor">#include &lt;sstream&gt;</span>
00014 <span class="preprocessor">#include &lt;iostream&gt;</span>
00015 <span class="preprocessor">#include &lt;iomanip&gt;</span>
00016 <span class="preprocessor">#include &lt;stack&gt;</span>
00017 <span class="preprocessor">#include &lt;typeinfo&gt;</span>
00018 <span class="preprocessor">#include &lt;functional&gt;</span>
00019 
00020 <span class="preprocessor">#include "<a class="code" href="random_8h.html">random.h</a>"</span>
00021 <span class="preprocessor">#include "<a class="code" href="serialfuncs_8h.html">serialfuncs.h</a>"</span>
00022 
00023 <span class="keyword">namespace </span>BEAST {
00024 
00053 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00054"></a><a class="code" href="structBEAST_1_1MutationOperator.html">00054</a> <span class="keyword">struct </span><a class="code" href="structBEAST_1_1MutationOperator.html">MutationOperator</a>
00055 {
<a name="l00057"></a><a class="code" href="structBEAST_1_1MutationOperator.html#a0">00057</a>     <a class="code" href="structBEAST_1_1MutationOperator.html#a0">MutationOperator</a>(T min = -1.0, T max = 1.0):<a class="code" href="structBEAST_1_1MutationOperator.html#o0">minimum</a>(min), <a class="code" href="structBEAST_1_1MutationOperator.html#o1">maximum</a>(max){}
<a name="l00059"></a><a class="code" href="structBEAST_1_1MutationOperator.html#a1">00059</a>     T <a class="code" href="structBEAST_1_1MutationOperator.html#a1">operator()</a>(T t) { <span class="keywordflow">return</span> t + <a class="code" href="group__utilities.html#a4">randval</a>(<a class="code" href="structBEAST_1_1MutationOperator.html#o1">maximum</a> - <a class="code" href="structBEAST_1_1MutationOperator.html#o0">minimum</a>) + <a class="code" href="structBEAST_1_1MutationOperator.html#o0">minimum</a>; }
00060 
00061     T <a class="code" href="structBEAST_1_1MutationOperator.html#o0">minimum</a>,  
<a name="l00062"></a><a class="code" href="structBEAST_1_1MutationOperator.html#o0">00062</a>       <a class="code" href="structBEAST_1_1MutationOperator.html#o1">maximum</a>;  
00063 };
00064 
00065 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
00066 <span class="keyword">struct </span>NormalMutator
00067 {
00069     NormalMutator(T m = 0.0, T s = 0.5):mean(m), sd(s){}
00071     T operator()(T t) { <span class="keywordflow">return</span> <a class="code" href="group__utilities.html#a11">normrand</a>(mean, sd); }
00072 
00073     T mean, 
00074       sd;   
00075 };
00076 
00084 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00085"></a><a class="code" href="group__biosystems.html#a6">00085</a> std::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, const MutationOperator&lt;T&gt;&amp; m)
00086 {
00087     out &lt;&lt; m.minimum &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; m.maximum &lt;&lt; std::endl;
00088 }
00089 
00097 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00098"></a><a class="code" href="group__biosystems.html#a7">00098</a> std::istream&amp; <a class="code" href="group__biosystems.html#a3">operator&gt;&gt;</a>(std::istream&amp; in, MutationOperator&lt;T&gt;&amp; m)
00099 {
00100     in &gt;&gt; m.minimum &gt;&gt; m.maximum;
00101 }
00102 
00115 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00116"></a><a class="code" href="classBEAST_1_1Evolver.html">00116</a> <span class="keyword">class </span><a class="code" href="classBEAST_1_1Evolver.html">Evolver</a>
00117 {
00118 <span class="keyword">public</span>:
00119 
00120     <span class="keyword">typedef</span> T                       gene_type;
00121     <span class="keyword">typedef</span> <span class="keyword">typename</span> std::vector&lt;T&gt; genotype_type;
00122 
00123     <span class="keyword">virtual</span> ~<a class="code" href="classBEAST_1_1Evolver.html">Evolver</a>(){}
00124 
00125     <span class="keyword">virtual</span> genotype_type <a class="code" href="classBEAST_1_1Evolver.html#a1">GetGenotype</a>()<span class="keyword">const</span> = 0;   
00126     <span class="keyword">virtual</span> <span class="keywordtype">void</span>        <a class="code" href="classBEAST_1_1Evolver.html#a2">SetGenotype</a>(<span class="keyword">const</span> genotype_type&amp;) = 0;  
00127     <span class="keyword">virtual</span> <span class="keywordtype">float</span>       <a class="code" href="classBEAST_1_1Evolver.html#a3">GetFitness</a>()<span class="keyword">const</span> = 0;  
00128 
<a name="l00135"></a><a class="code" href="classBEAST_1_1Evolver.html#a4">00135</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span>        <a class="code" href="classBEAST_1_1Evolver.html#a4">StoreFitness</a>() { <a class="code" href="classBEAST_1_1Evolver.html#o0">GAFitnessScores</a>.push_back(<a class="code" href="classBEAST_1_1Evolver.html#a3">GetFitness</a>()); }
<a name="l00136"></a><a class="code" href="classBEAST_1_1Evolver.html#o0">00136</a>     std::vector&lt;float&gt;  <a class="code" href="classBEAST_1_1Evolver.html#o0">GAFitnessScores</a>;    
<a name="l00137"></a><a class="code" href="classBEAST_1_1Evolver.html#o1">00137</a>     <span class="keywordtype">float</span>               <a class="code" href="classBEAST_1_1Evolver.html#o1">GAProbability</a>;      
<a name="l00138"></a><a class="code" href="classBEAST_1_1Evolver.html#o2">00138</a>     <span class="keywordtype">float</span>               <a class="code" href="classBEAST_1_1Evolver.html#o2">GAFixedFitness</a>;     
00139 
00140     genotype_type       PSOBestSolution;
00141     <span class="keywordtype">float</span>               PSOBestFitness;
00142 };
00143 
<a name="l00145"></a><a class="code" href="group__biosystems.html#a13">00145</a> <span class="keyword">enum</span> <a class="code" href="group__biosystems.html#a13">GASelectionType</a> {
00146     <a class="code" href="group__biosystems.html#a13a34">GA_ROULETTE</a> = 0,    
00147     <a class="code" href="group__biosystems.html#a13a35">GA_RANK</a>,            
00148     <a class="code" href="group__biosystems.html#a13a36">GA_TOURNAMENT</a>       
00149 };
00150 
<a name="l00152"></a><a class="code" href="group__biosystems.html#a14">00152</a> <span class="keyword">enum</span> <a class="code" href="group__biosystems.html#a14">GAFltParamType</a> {
00153     <a class="code" href="group__biosystems.html#a14a37">GA_TOURNAMENT_PARAM</a>, 
00154     <a class="code" href="group__biosystems.html#a14a38">GA_RANK_SPRESSURE</a>,  
00155     <a class="code" href="group__biosystems.html#a14a39">GA_EXPONENT</a>         
00156 };
00157 
<a name="l00159"></a><a class="code" href="group__biosystems.html#a15">00159</a> <span class="keyword">enum</span> <a class="code" href="group__biosystems.html#a15">GAIntParamType</a> {
00160     <a class="code" href="group__biosystems.html#a15a40">GA_TOURNAMENT_SIZE</a>  
00161 };
00162 
<a name="l00164"></a><a class="code" href="group__biosystems.html#a16">00164</a> <span class="keyword">enum</span> <a class="code" href="group__biosystems.html#a16">GAPrintStyleType</a> {
00165     <a class="code" href="group__biosystems.html#a16a41">GA_PARAMETERS</a> = 1,  
00166     <a class="code" href="group__biosystems.html#a16a42">GA_CURRENT</a> = 2,     
00167     <a class="code" href="group__biosystems.html#a16a43">GA_GENERATION</a> = 4,  
00168     <a class="code" href="group__biosystems.html#a16a44">GA_HISTORY</a> = 8      
00169 };
00170 
<a name="l00172"></a><a class="code" href="group__biosystems.html#a17">00172</a> <span class="keyword">enum</span> <a class="code" href="group__biosystems.html#a17">GAFitnessMethodType</a> {
00173     <a class="code" href="group__biosystems.html#a17a45">GA_BEST_FITNESS</a>,    
00174     <a class="code" href="group__biosystems.html#a17a46">GA_WORST_FITNESS</a>,   
00175     <a class="code" href="group__biosystems.html#a17a47">GA_MEAN_FITNESS</a>,    
00176     <a class="code" href="group__biosystems.html#a17a48">GA_TOTAL_FITNESS</a>    
00177 };
00178 
<a name="l00180"></a><a class="code" href="group__biosystems.html#a18">00180</a> <span class="keyword">enum</span> <a class="code" href="group__biosystems.html#a18">GAFitnessFixType</a>   {
00181     <a class="code" href="group__biosystems.html#a18a49">GA_IGNORE</a>,          
00182     <a class="code" href="group__biosystems.html#a18a50">GA_CLAMP</a>,           
00183     <a class="code" href="group__biosystems.html#a18a51">GA_FIX</a>              
00184 };
00185 
00186 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt; <span class="keyword">class </span>GeneticAlgorithm;
00188 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
00189 std::ostream&amp; operator&lt;&lt; (std::ostream&amp;, const GeneticAlgorithm&lt;EVO, MUTFUNC&gt;&amp;);
00191 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
00192 std::istream&amp; <a class="code" href="group__biosystems.html#a3">operator&gt;&gt; </a>(std::istream&amp;, <span class="keyword">const</span> GeneticAlgorithm&lt;EVO, MUTFUNC&gt;&amp;);
00193 
00207 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC = MutationOperator&lt;<span class="keyword">typename</span> EVO::gene_type&gt; &gt;
<a name="l00208"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html">00208</a> <span class="keyword">class </span><a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm</a>
00209 {
00210 <span class="keyword">public</span>:
<a name="l00212"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w0">00212</a>     <span class="keyword">typedef</span> <span class="keyword">typename</span> EVO::gene_type <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w0">GENE</a>;
<a name="l00214"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w1">00214</a>     <span class="keyword">typedef</span> <span class="keyword">typename</span> EVO::genotype_type <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w1">GENOTYPE</a>;
<a name="l00216"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w2">00216</a>     <span class="keyword">typedef</span> <span class="keyword">typename</span> std::vector&lt;EVO*&gt;::iterator <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w2">PopIter</a>;
<a name="l00218"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w3">00218</a>     <span class="keyword">typedef</span> <span class="keyword">typename</span> std::vector&lt;EVO*&gt;::const_iterator <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w3">PopConstIter</a>;
<a name="l00220"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w4">00220</a>     <span class="keyword">typedef</span> <span class="keyword">typename</span> std::vector&lt;GENE&gt;::iterator <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w4">ChromIter</a>;
00221 
00222     <a class="code" href="group__biosystems.html#a21">GeneticAlgorithm</a>(<span class="keywordtype">float</span> crossover = 0.7f, <span class="keywordtype">float</span> mutation = 0.01f, <span class="keywordtype">int</span> popSize = 0);
00223     <span class="keyword">virtual</span> ~<a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm</a>();
00224 
00225     <span class="keywordtype">void</span>            SetPopulation(<span class="keyword">const</span> std::vector&lt;EVO*&gt;&amp; p){ population = p; }
00226     std::vector&lt;EVO*&gt;&amp;  GetPopulation()                 { <span class="keywordflow">return</span> outputPopulation; }
00227     std::vector&lt;EVO*&gt;   <a class="code" href="group__biosystems.html#a23">GetPopulationCopy</a>()<span class="keyword">const</span>;
00228     <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w2">PopIter</a>         begin() { <span class="keywordflow">return</span> outputPopulation.begin(); }
00229     <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w2">PopIter</a>         end() { <span class="keywordflow">return</span> outputPopulation.end(); }
00230 
<a name="l00233"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a7">00233</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a7">SetCrossover</a>(<span class="keywordtype">float</span> c)               { crossover = c; }
<a name="l00236"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a8">00236</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a8">SetMutation</a>(<span class="keywordtype">float</span> m)                { mutation = m; }
<a name="l00239"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a9">00239</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a9">SetSelection</a>(GASelectionType s)     { selection = s; }
<a name="l00243"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a10">00243</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a10">SetMutationFunction</a>(GENE (*ptr)(GENE))  { mutFuncPtr = ptr; }
<a name="l00246"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a11">00246</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a10">SetMutationFunction</a>(MUTFUNC obj)    { mutFuncObj = obj; }
<a name="l00250"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a12">00250</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a12">SetElitism</a>(<span class="keywordtype">int</span> e)                   { elitism = e; }
<a name="l00254"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a13">00254</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a13">SetSubelitism</a>(<span class="keywordtype">int</span> s)                { subelitism = s; }
<a name="l00257"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a14">00257</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a14">SetCrossoverPoints</a>(<span class="keywordtype">int</span> p)           { crossoverPoints = p; }
<a name="l00260"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a15">00260</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a15">SetFitnessMethod</a>(GAFitnessMethodType f) { fitnessMethod = f; }
<a name="l00263"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a16">00263</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a16">SetFitnessFix</a>(GAFitnessFixType f)   { fitnessFix = f; }
00264 
<a name="l00267"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a17">00267</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a17">SetOwnsData</a>(<span class="keywordtype">bool</span> b)                 { ownsData = b; }
<a name="l00272"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a18">00272</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a18">SetParameter</a>(GAFltParamType p, <span class="keywordtype">float</span> f) { fltParams[p] = f; }
<a name="l00277"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a19">00277</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a18">SetParameter</a>(GAIntParamType p, <span class="keywordtype">int</span> n) { intParams[p] = n; }
<a name="l00280"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a20">00280</a>     <span class="keywordtype">void</span>            <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a20">SetPrintStyle</a>(<span class="keywordtype">int</span> p)                { printStyle = p; }
00281 
00282     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a class="code" href="group__biosystems.html#a24">Generate</a>();
00283     <span class="keywordtype">void</span>            <a class="code" href="group__biosystems.html#a25">ReGenerate</a>();
00284 
<a name="l00286"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a23">00286</a>     <span class="keywordtype">int</span>             <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a23">GetGenerations</a>()<span class="keyword">const</span>               { <span class="keywordflow">return</span> generations; }
00287     std::vector&lt;float&gt;  GetAvgFitnessHistory()<span class="keyword">const</span>     { <span class="keywordflow">return</span> bestFitnessRecord; }
00288     std::vector&lt;float&gt;  GetBestFitnessHistory()<span class="keyword">const</span>    { <span class="keywordflow">return</span> bestFitnessHistory; }
00289     std::vector&lt;GENE&gt;   GetBestCurrentGenome()<span class="keyword">const</span>     { <span class="keywordflow">return</span> bestCurrentGenome; }
00290     std::vector&lt;GENE&gt;   GetBestEverGenome()<span class="keyword">const</span>        { <span class="keywordflow">return</span> bestEverGenome; }
00291     <span class="keywordtype">float</span>           GetBestCurrentFitness()<span class="keyword">const</span>        { <span class="keywordflow">return</span> bestFitness; }
00292     <span class="keywordtype">float</span>           GetBestEverFitness()                { <span class="keywordflow">return</span> bestEverFitness; }
00293 
00294     std::string     <a class="code" href="group__biosystems.html#a35">ToString</a>()<span class="keyword">const</span>;
00295     std::string     <a class="code" href="group__biosystems.html#a36">GetCSV</a>(<span class="keywordtype">char</span> separator = <span class="charliteral">','</span>)<span class="keyword">const</span>;
00296 
00297     <span class="keywordtype">void</span>            <a class="code" href="group__biosystems.html#a37">CleanUp</a>();
00298 
00299     <span class="keywordtype">void</span>            Unserialise(std::istream&amp;);
00300     <span class="keywordtype">void</span>            Serialise(std::ostream&amp;)<span class="keyword">const</span>;
00301 
00302 <span class="keyword">protected</span>:
00303     <span class="comment">// Methods used in creation of a new generation</span>
00304     <span class="keywordtype">void</span>            <a class="code" href="group__biosystems.html#a26">CalcStats</a>();
00305     <span class="keywordtype">void</span>            <a class="code" href="group__biosystems.html#a27">Setup</a>();
00306     <span class="keywordtype">void</span>            <a class="code" href="group__biosystems.html#a28">FixFitness</a>();
00307     <span class="keywordtype">float</span>           <a class="code" href="group__biosystems.html#a29">GetFitness</a>(EVO* i);
00308     <span class="keywordtype">void</span>            <a class="code" href="group__biosystems.html#a30">SelectParentGenotype</a>(GENOTYPE&amp;);
00309     <span class="keywordtype">void</span>            <a class="code" href="group__biosystems.html#a33">CrossoverGenotypes</a>(GENOTYPE&amp;, GENOTYPE&amp;);
00310     <span class="keywordtype">void</span>            <a class="code" href="group__biosystems.html#a34">MutateGenotype</a>(GENOTYPE&amp;);
00311 
00312     <span class="comment">// Selection methods</span>
00313     <span class="keywordtype">void</span>            <a class="code" href="group__biosystems.html#a31">SelectProbability</a>(GENOTYPE&amp;);
00314     <span class="keywordtype">void</span>            SelectEven(GENOTYPE&amp;);
00315     <span class="keywordtype">void</span>            <a class="code" href="group__biosystems.html#a32">SelectTournament</a>(GENOTYPE&amp;);
00316 
00318     <span class="keyword">template</span> &lt;<span class="keyword">class</span> _EVO&gt;
<a name="l00319"></a><a class="code" href="structBEAST_1_1GeneticAlgorithm_1_1evo__sort.html">00319</a>     <span class="keyword">struct </span><a class="code" href="structBEAST_1_1GeneticAlgorithm_1_1evo__sort.html">evo_sort</a> {
00320         <span class="keywordtype">bool</span> operator()(_EVO*<span class="keyword">const</span> &amp; p1, _EVO*<span class="keyword">const</span> &amp; p2)
00321         { <span class="keywordflow">return</span> p1-&gt;GAFixedFitness &lt; p2-&gt;GAFixedFitness;}
00322     };
00323 
00324 <span class="keyword">private</span>:
00325     std::vector&lt;EVO*&gt;   population;     
00326     std::vector&lt;EVO*&gt;   outputPopulation;
00327 
00328     <span class="comment">// These attributes define the behaviour of the algorithm</span>
00329     <span class="keywordtype">float</span>           crossover;          
00330     <span class="keywordtype">float</span>           mutation;           
00331     <a class="code" href="group__biosystems.html#a13">GASelectionType</a> selection;          
00332     <span class="keywordtype">int</span>             outputPopSize;      
00333     <span class="keywordtype">int</span>             elitism;            
00334     <span class="keywordtype">int</span>             subelitism;         
00335     <span class="keywordtype">int</span>             crossoverPoints;    
00336     <a class="code" href="group__biosystems.html#a17">GAFitnessMethodType</a> fitnessMethod;  
00337     <a class="code" href="group__biosystems.html#a18">GAFitnessFixType</a> fitnessFix;        
00338 
00339     std::map&lt;GAFltParamType,float&gt;  fltParams;  
00340     std::map&lt;GAIntParamType,int&gt;    intParams;  
00341     <span class="keywordtype">bool</span>            ownsData;           
00342     <span class="keywordtype">int</span>             printStyle;         
00343 
00344     <span class="comment">// Attributes for storing the algorithm's history</span>
00345     <span class="keywordtype">int</span>                 generations;        
00346     std::vector&lt;float&gt;  averageFitnessRecord;   
00347     std::vector&lt;float&gt;  bestFitnessRecord;  
00348     <span class="keywordtype">float</span>               bestEverFitness;    
00349     std::vector&lt;GENE&gt;   bestEverGenome;     
00350     std::vector&lt;GENE&gt;   bestCurrentGenome;  
00351 
00352     <span class="comment">// Data used during creation of a new generation</span>
00353     <span class="keywordtype">int</span>             inputPopSize;       
00354     <span class="keywordtype">int</span>             chromoLength;       
00355     <span class="keywordtype">float</span>           totalFitness;       
00356     <span class="keywordtype">float</span>           bestFitness;        
00357     <span class="keywordtype">float</span>           totalFixedFitness;  
00358     <span class="keywordtype">float</span>           worstFitness;       
00359     <span class="keywordtype">float</span>           totalProbability;   
00360 
00362     MUTFUNC         mutFuncObj;
00364     <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w0">GENE</a>            (*mutFuncPtr)(<a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w0">GENE</a>);
00365 };
00366 
00367 
00373 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
<a name="l00374"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a21">00374</a> <a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::GeneticAlgorithm</a>(<span class="keywordtype">float</span> c, <span class="keywordtype">float</span> m, <span class="keywordtype">int</span> p):
00375 crossover(c), mutation(m), selection(<a class="code" href="group__biosystems.html#a13a34">GA_ROULETTE</a>), outputPopSize(p),
00376 elitism(0), subelitism(0), crossoverPoints(1), fitnessMethod(<a class="code" href="group__biosystems.html#a17a47">GA_MEAN_FITNESS</a>),
00377 fitnessFix(<a class="code" href="group__biosystems.html#a18a49">GA_IGNORE</a>),
00378 ownsData(false), printStyle(<a class="code" href="group__biosystems.html#a16a42">GA_CURRENT</a>),
00379 generations(0), bestFitness(0.0f), mutFuncPtr(NULL)
00380 {
00381     fltParams[<a class="code" href="group__biosystems.html#a14a37">GA_TOURNAMENT_PARAM</a>] = 0.75f;
00382     fltParams[<a class="code" href="group__biosystems.html#a14a38">GA_RANK_SPRESSURE</a>] = 1.5f;
00383     fltParams[<a class="code" href="group__biosystems.html#a14a39">GA_EXPONENT</a>] = 1.0f;
00384 
00385     intParams[<a class="code" href="group__biosystems.html#a15a40">GA_TOURNAMENT_SIZE</a>] = 2;
00386 }
00387 
00388 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
00389 GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::~GeneticAlgorithm()
00390 {
00391     <span class="comment">// CleanUp();</span>
00392 }
00393 
00394 
00399 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
<a name="l00400"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a23">00400</a> std::vector&lt;EVO*&gt; <a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::GetPopulationCopy</a>()<span class="keyword">const</span>
00401 {
00402     std::vector&lt;EVO*&gt; popCopy;
00403 
00404     <span class="keywordflow">for</span> (PopConstIter i = outputPopulation.begin(); i != outputPopulation.end(); ++i) {
00405         popCopy.push_back(<span class="keyword">new</span> EVO(**i));
00406     }
00407 
00408     <span class="keywordflow">return</span> popCopy;
00409 }
00410 
00411 
00420 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
<a name="l00421"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a24">00421</a> <span class="keywordtype">void</span> <a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::Generate</a>()
00422 {
00423     <a class="code" href="group__biosystems.html#a26">CalcStats</a>();
00424     <a class="code" href="group__biosystems.html#a27">Setup</a>();
00425 
00426     std::vector&lt;GENE&gt; chromo1, chromo2;
00427     EVO *evo;
00428 
00429     <span class="keywordtype">int</span> i = 0, j;
00430     <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w2">PopIter</a> iter = population.begin();
00431 
00432     <span class="keywordflow">if</span> (elitism + subelitism &lt; inputPopSize - 2) {
00433         <span class="comment">// First, remove the worst &lt;subelitism&gt; individuals from the population to</span>
00434         <span class="comment">// ensure they never get to pass on their rubbish genes.</span>
00435         <span class="keywordflow">for</span> (; i &lt; subelitism; ++i) {
00436             population.pop_back();
00437         }
00438 
00439         <span class="comment">// Next, fill the first &lt;elitism&gt; slots in the new generation with the</span>
00440         <span class="comment">// top individuals from the input population</span>
00441         <span class="keywordflow">for</span> (i = 0; i &lt; elitism &amp;&amp; iter != population.end(); ++i, ++iter) {
00442             evo = <span class="keyword">new</span> EVO;
00443             evo-&gt;SetGenotype((*iter)-&gt;GetGenotype());
00444             outputPopulation.push_back(evo);
00445         }
00446     }
00447 
00449     <span class="keywordflow">for</span> (; i &lt; outputPopSize / 2; ++i) {
00450         <a class="code" href="group__biosystems.html#a30">SelectParentGenotype</a>(chromo1);
00451         <a class="code" href="group__biosystems.html#a30">SelectParentGenotype</a>(chromo2);
00452         <span class="keywordflow">for</span> (j=0; j&lt;crossoverPoints; ++j) {
00453             <span class="keywordflow">if</span> (<a class="code" href="group__utilities.html#a4">randval</a>(1.0) &lt; crossover) <a class="code" href="group__biosystems.html#a33">CrossoverGenotypes</a>(chromo1, chromo2);
00454         }
00455         <a class="code" href="group__biosystems.html#a34">MutateGenotype</a>(chromo1);
00456         <a class="code" href="group__biosystems.html#a34">MutateGenotype</a>(chromo2);
00457         evo = <span class="keyword">new</span> EVO;
00458         evo-&gt;SetGenotype(chromo1);
00459         outputPopulation.push_back(evo);
00460         evo = <span class="keyword">new</span> EVO;
00461         evo-&gt;SetGenotype(chromo2);
00462         outputPopulation.push_back(evo);
00463     }
00464 
00465     <span class="keywordflow">if</span> (ownsData) {
00466         <span class="comment">// Delete the input population</span>
00467         <span class="keywordflow">for</span> (<a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w2">PopIter</a> i = population.begin(); i != population.end(); ++i) {
00468             <span class="keyword">delete</span> *i;
00469         }
00470     }
00471 }
00472 
00473 
00477 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
<a name="l00478"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a25">00478</a> <span class="keywordtype">void</span> <a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::ReGenerate</a>()
00479 {
00480     <a class="code" href="group__biosystems.html#a24">Generate</a>();
00481     population = outputPopulation;
00482 }
00483 
00488 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
<a name="l00489"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a26">00489</a> <span class="keywordtype">void</span> <a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::CalcStats</a>()
00490 {
00491     <span class="comment">// First find out how many we're dealing with</span>
00492     inputPopSize = static_cast&lt;int&gt;(population.size());
00493 
00494     <span class="comment">// Now calculate total fitness and find best fitness</span>
00495     <span class="keywordtype">float</span> f;    <span class="comment">// just a temp storage value</span>
00496 
00497     <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w2">PopIter</a> iter = population.begin();
00498     EVO* bestEvoSoFar = *iter;
00499     totalFitness = bestFitness = worstFitness = <a class="code" href="group__biosystems.html#a29">GetFitness</a>(*iter);
00500 
00501     <span class="keywordflow">for</span> (++iter; iter != population.end(); ++iter) {
00502         f = <a class="code" href="group__biosystems.html#a29">GetFitness</a>(*iter);
00503 
00504         <span class="keywordflow">if</span> (f &gt; bestFitness) {
00505             bestEvoSoFar = *iter;
00506             bestFitness = f;
00507         }
00508         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (f &lt; worstFitness) {
00509             worstFitness = f;
00510         }
00511 
00512         totalFitness += f;
00513     }
00514 
00515     <span class="comment">// Store some statistics</span>
00516     ++generations;
00517     averageFitnessRecord.push_back(totalFitness / static_cast&lt;float&gt;(inputPopSize));
00518     bestFitnessRecord.push_back(bestFitness);
00519     bestCurrentGenome = bestEvoSoFar-&gt;GetGenotype();
00520     <span class="keywordflow">if</span> (bestFitness &gt; bestEverFitness) {
00521         bestEverFitness = bestFitness;
00522         bestEverGenome = bestCurrentGenome;
00523     }
00524 }
00525 
00531 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
<a name="l00532"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a27">00532</a> <span class="keywordtype">void</span> <a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::Setup</a>()
00533 {
00534     outputPopulation.clear();
00535     <span class="keywordflow">if</span> (outputPopSize == 0) outputPopSize = static_cast&lt;int&gt;(population.size());
00537     chromoLength = static_cast&lt;int&gt;(population.front()-&gt;GetGenotype().size());
00538 
00539     <a class="code" href="group__biosystems.html#a28">FixFitness</a>();
00540 
00541     <span class="comment">// Elitism, subelitism and rank selection require population to be</span>
00542     <span class="comment">// sorted by fitness (best-worst)</span>
00543     sort(population.rbegin(), population.rend(), <a class="code" href="structBEAST_1_1GeneticAlgorithm_1_1evo__sort.html">evo_sort&lt;EVO&gt;</a>());
00544 
00545     <span class="comment">// Probability distribution Setup:</span>
00546     <span class="comment">// Each individual has a public attribute, GAProbability, which is used</span>
00547     <span class="comment">// to store probability distribution data. In the following code this</span>
00548     <span class="comment">// attribute is precalculated in order to speed up the selection process.</span>
00549 
00550     totalProbability = 0;
00551 
00552     <span class="comment">// Roulette wheel selection:</span>
00553     <span class="comment">// Each individual's GAProbability attribute is primed with a value</span>
00554     <span class="comment">// corresponding to their fitness compared to the overall population.</span>
00555     <span class="keywordflow">if</span> (selection == <a class="code" href="group__biosystems.html#a13a34">GA_ROULETTE</a>) {
00556         <span class="keywordflow">for</span> (<a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w2">PopIter</a> i = population.begin(); i != population.end(); ++i) {
00557             (*i)-&gt;GAProbability = static_cast&lt;float&gt;(pow((*i)-&gt;GAFixedFitness / totalFixedFitness,
00558                                                          fltParams[<a class="code" href="group__biosystems.html#a14a39">GA_EXPONENT</a>]));
00559             totalProbability += (*i)-&gt;GAProbability;
00560         }
00561     }
00562 
00563     <span class="comment">// Rank selection:</span>
00564     <span class="comment">// The relative rank of the invidual is used, preventing one or two</span>
00565     <span class="comment">// overwhelmingly fit individuals in a population from dominating the next</span>
00566     <span class="comment">// generation. So if in a population of 3 individuals you had scores of</span>
00567     <span class="comment">// (2, 3, 400), rank selection would convert these to (0.167, 0.333, 0.5).</span>
00568     <span class="keywordflow">if</span> (selection == <a class="code" href="group__biosystems.html#a13a35">GA_RANK</a>) {
00569         <span class="keywordtype">float</span> sp = fltParams[<a class="code" href="group__biosystems.html#a14a38">GA_RANK_SPRESSURE</a>];
00570         <span class="keywordtype">float</span> fltInputPopSize = static_cast&lt;float&gt;(inputPopSize);
00571 
00572         <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w2">PopIter</a> it = population.begin();
00573         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = inputPopSize; it != population.end(); --i, ++it) {
00574             <span class="comment">// This handy ranking equation ensures that with no exponent</span>
00575             <span class="comment">// (GA_EXPONENT==1) the total probability is 1, useful for</span>
00576             <span class="comment">// debugging.</span>
00577             (*it)-&gt;GAProbability = (2.0f - sp + 2.0f * (sp - 1.0f)
00578                                  * static_cast&lt;float&gt;(i - 1)
00579                                  / static_cast&lt;float&gt;(inputPopSize - 1))
00580                                  / fltInputPopSize;
00581             (*it)-&gt;GAProbability = static_cast&lt;float&gt;(pow((*it)-&gt;GAProbability,fltParams[<a class="code" href="group__biosystems.html#a14a39">GA_EXPONENT</a>]));
00582             totalProbability += (*it)-&gt;GAProbability;
00583         }
00584     }
00585 }
00586 
00590 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
<a name="l00591"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a28">00591</a> <span class="keywordtype">void</span> <a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::FixFitness</a>()
00592 {
00593     <span class="keywordtype">float</span> f;
00594     totalFixedFitness = 0;
00595 
00596     <span class="keywordflow">for</span> (<a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w2">PopIter</a> i = population.begin(); i != population.end(); ++i) {
00597         f = <a class="code" href="group__biosystems.html#a29">GetFitness</a>(*i);
00598         <span class="keywordflow">switch</span> (fitnessFix) {
00599         <span class="keywordflow">case</span> <a class="code" href="group__biosystems.html#a18a51">GA_FIX</a>: f -= worstFitness; <span class="keywordflow">break</span>;
00600         <span class="keywordflow">case</span> <a class="code" href="group__biosystems.html#a18a50">GA_CLAMP</a>: f = (f &lt; 0 ? 0 : f); <span class="keywordflow">break</span>;
00601         <span class="keywordflow">case</span> <a class="code" href="group__biosystems.html#a18a49">GA_IGNORE</a>: <span class="keywordflow">break</span>;
00602         }
00603         (*i)-&gt;GAFixedFitness = f;
00604 
00605         totalFixedFitness += f;
00606     }
00607 }
00608 
00614 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
<a name="l00615"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a29">00615</a> <span class="keywordtype">float</span> <a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::GetFitness</a>(EVO* i)
00616 {
00617     <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00618 
00619     <span class="keywordflow">if</span> (i-&gt;GAFitnessScores.empty()) {
00620         <span class="keywordflow">return</span> i-&gt;GetFitness();
00621     }
00622 
00623     <span class="keywordflow">switch</span> (fitnessMethod) {
00624     <span class="keywordflow">case</span> <a class="code" href="group__biosystems.html#a17a45">GA_BEST_FITNESS</a>:
00625         <span class="keywordflow">return</span> *max_element(i-&gt;GAFitnessScores.begin(),
00626                            i-&gt;GAFitnessScores.end());
00627     <span class="keywordflow">case</span> <a class="code" href="group__biosystems.html#a17a46">GA_WORST_FITNESS</a>:
00628         <span class="keywordflow">return</span> *min_element(i-&gt;GAFitnessScores.begin(),
00629                            i-&gt;GAFitnessScores.end());
00630     <span class="keywordflow">case</span> <a class="code" href="group__biosystems.html#a17a47">GA_MEAN_FITNESS</a>:
00631         <span class="keywordflow">return</span> accumulate(i-&gt;GAFitnessScores.begin(),
00632                           i-&gt;GAFitnessScores.end(), 0.0f)
00633              / static_cast&lt;float&gt;(i-&gt;GAFitnessScores.size());
00634     <span class="keywordflow">case</span> <a class="code" href="group__biosystems.html#a17a48">GA_TOTAL_FITNESS</a>:
00635         <span class="keywordflow">return</span> accumulate(i-&gt;GAFitnessScores.begin(),
00636                           i-&gt;GAFitnessScores.end(), 0.0f);
00637     <span class="keywordflow">default</span>:
00638         <span class="keywordflow">return</span> 0.0f;
00639     }
00640 }
00641 
00646 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
<a name="l00647"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a30">00647</a> <span class="keywordtype">void</span> <a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::SelectParentGenotype</a>(GENOTYPE&amp; chromo)
00648 {
00649     <span class="keywordflow">switch</span> (selection) {
00650     <span class="keywordflow">case</span> <a class="code" href="group__biosystems.html#a13a34">GA_ROULETTE</a>:
00651     <span class="keywordflow">case</span> <a class="code" href="group__biosystems.html#a13a35">GA_RANK</a>:           <a class="code" href="group__biosystems.html#a31">SelectProbability</a>(chromo);  <span class="keywordflow">break</span>;
00652     <span class="keywordflow">case</span> <a class="code" href="group__biosystems.html#a13a36">GA_TOURNAMENT</a>:     <a class="code" href="group__biosystems.html#a32">SelectTournament</a>(chromo);   <span class="keywordflow">break</span>;
00653     }
00654 }
00655 
00656 
00667 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
<a name="l00668"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a31">00668</a> <span class="keywordtype">void</span> <a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::SelectProbability</a>(GENOTYPE&amp; chromo)
00669 {
00670     <span class="keywordtype">float</span> slice = <a class="code" href="group__utilities.html#a4">randval</a>(totalProbability);
00671 
00672     <a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w2">PopIter</a> i = population.begin();
00673     <span class="keywordflow">for</span> (; i != population.end(); ++i) {
00674         slice -= (*i)-&gt;GAProbability;
00675         <span class="keywordflow">if</span> (slice &lt; 0) <span class="keywordflow">break</span>;
00676     }
00677 
00678     <span class="keywordflow">if</span> (i != population.end()) {
00679         chromo = (*i)-&gt;GetGenotype();
00680     }
00681     <span class="keywordflow">else</span> {
00682         chromo = (*(i - 1))-&gt;GetGenotype();
00683     }
00684 }
00685 
00686 
00695 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
<a name="l00696"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a32">00696</a> <span class="keywordtype">void</span> <a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::SelectTournament</a>(GENOTYPE&amp; chromo)
00697 {
00698     std::vector&lt;EVO*&gt; tournament;
00699 
00700     <span class="comment">// Pick GA_TOURNAMENT_SIZE individuals at random</span>
00701     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;intParams[<a class="code" href="group__biosystems.html#a15a40">GA_TOURNAMENT_SIZE</a>]; ++i) {
00702         tournament.push_back(population[<a class="code" href="group__utilities.html#a5">irand</a>(inputPopSize)]);
00703     }
00704 
00705     <span class="comment">// Decide the winner...</span>
00706     EVO* winner;
00707     <span class="comment">// Depending on GA_TOURNAMENT_PARAM,</span>
00708     <span class="keywordflow">if</span> (<a class="code" href="group__utilities.html#a4">randval</a>(1.0f) &lt; fltParams[<a class="code" href="group__biosystems.html#a14a37">GA_TOURNAMENT_PARAM</a>]) {
00709         <span class="comment">// The fittest individual is chosen:</span>
00710         winner = *(max_element(tournament.begin(), tournament.end(), <a class="code" href="structBEAST_1_1GeneticAlgorithm_1_1evo__sort.html">evo_sort&lt;EVO&gt;</a>()));
00711     }
00712     <span class="keywordflow">else</span> {
00713         <span class="comment">// Or an invidiual is chosen at random</span>
00714         winner = tournament[<a class="code" href="group__utilities.html#a5">irand</a>(intParams[<a class="code" href="group__biosystems.html#a15a40">GA_TOURNAMENT_SIZE</a>])];
00715     }
00716 
00717     chromo = winner-&gt;GetGenotype();
00718 }
00719 
00725 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
<a name="l00726"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a33">00726</a> <span class="keywordtype">void</span> <a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::CrossoverGenotypes</a>(GENOTYPE&amp; mum, GENOTYPE&amp; dad)
00727 {
00728     <span class="keywordtype">int</span> crossoverPoint = static_cast&lt;int&gt;(<a class="code" href="group__utilities.html#a4">randval</a>(1.0f) * chromoLength);
00729     swap_ranges(mum.begin() + crossoverPoint, mum.end(), dad.begin() + crossoverPoint);
00730 }
00731 
00737 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
<a name="l00738"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a34">00738</a> <span class="keywordtype">void</span> <a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::MutateGenotype</a>(GENOTYPE&amp; chromo)
00739 {
00740     <span class="keywordflow">for</span> (<a class="code" href="classBEAST_1_1GeneticAlgorithm.html#w4">ChromIter</a> i= chromo.begin(); i != chromo.end(); ++i) {
00741         <span class="keywordflow">if</span> (<a class="code" href="group__utilities.html#a4">randval</a>(1.0f) &lt; mutation) {
00742             <span class="comment">// If a mutation function has been set, use that, otherwise use a</span>
00743             <span class="comment">// function object.</span>
00744             *i = (mutFuncPtr == NULL) ? mutFuncObj(*i) : mutFuncPtr(*i);
00745         }
00746     }
00747 }
00748 
00758 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
<a name="l00759"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a35">00759</a> std::string <a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::ToString</a>()<span class="keyword">const</span>
00760 {
00761     <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00762 
00763     ostringstream out;
00764 
00765     <span class="keywordflow">if</span> ((printStyle &amp; <a class="code" href="group__biosystems.html#a16a41">GA_PARAMETERS</a>) != 0) {
00766         out &lt;&lt; <span class="stringliteral">"Crossover:       "</span> &lt;&lt; setw(6) &lt;&lt; crossover &lt;&lt; <span class="stringliteral">"  "</span>
00767             &lt;&lt; <span class="stringliteral">"Mutation:        "</span> &lt;&lt; setw(6) &lt;&lt; mutation &lt;&lt; endl
00768             &lt;&lt; <span class="stringliteral">"Selection type:  "</span>;
00769         <span class="keywordflow">switch</span> (selection) {
00770         <span class="keywordflow">case</span> <a class="code" href="group__biosystems.html#a13a34">GA_ROULETTE</a>:
00771             out &lt;&lt; <span class="stringliteral">"roulette wheel selection"</span> &lt;&lt; endl;
00772             <span class="keywordflow">break</span>;
00773         <span class="keywordflow">case</span> <a class="code" href="group__biosystems.html#a13a35">GA_RANK</a>:
00774             out &lt;&lt; <span class="stringliteral">"rank selection"</span> &lt;&lt; endl;
00775             <span class="keywordflow">break</span>;
00776         <span class="keywordflow">case</span> <a class="code" href="group__biosystems.html#a13a36">GA_TOURNAMENT</a>:
00777             out &lt;&lt; <span class="stringliteral">"tournament selection"</span> &lt;&lt; endl
00778                 &lt;&lt; <span class="stringliteral">"Tournament size: "</span> &lt;&lt; setw(6)
00779                 &lt;&lt; intParams.find(<a class="code" href="group__biosystems.html#a15a40">GA_TOURNAMENT_SIZE</a>)-&gt;second &lt;&lt; <span class="stringliteral">"  "</span>
00780                 &lt;&lt; <span class="stringliteral">"Chance of win:   "</span> &lt;&lt; setw(6)
00781                 &lt;&lt; fltParams.find(<a class="code" href="group__biosystems.html#a14a37">GA_TOURNAMENT_PARAM</a>)-&gt;second &lt;&lt; endl;
00782             <span class="keywordflow">break</span>;
00783         }
00784         out &lt;&lt; <span class="stringliteral">"Elitism:         "</span> &lt;&lt; setw(6) &lt;&lt; elitism &lt;&lt; <span class="stringliteral">"  "</span>
00785             &lt;&lt; <span class="stringliteral">"Sub-elitism:     "</span> &lt;&lt; setw(6) &lt;&lt; subelitism &lt;&lt; endl
00786             &lt;&lt; <span class="stringliteral">"Output population size: "</span> &lt;&lt; outputPopSize &lt;&lt; endl &lt;&lt; endl;
00787     }
00788 
00789     <span class="keywordflow">if</span> ((printStyle &amp; <a class="code" href="group__biosystems.html#a16a42">GA_CURRENT</a>) != 0) {
00790         out &lt;&lt; <span class="stringliteral">"Generation: "</span> &lt;&lt; setw(6) &lt;&lt; generations &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; <span class="stringliteral">"Average fitness: "</span>
00791             &lt;&lt; setw(8) &lt;&lt; totalFitness / static_cast&lt;float&gt;(inputPopSize) &lt;&lt; <span class="stringliteral">"   "</span>
00792             &lt;&lt; <span class="stringliteral">"Best fitness: "</span> &lt;&lt; setw(8) &lt;&lt; bestFitness &lt;&lt; endl;
00793     }
00794 
00795     <span class="keywordflow">if</span> ((printStyle &amp; <a class="code" href="group__biosystems.html#a16a43">GA_GENERATION</a>) != 0) {
00796         <span class="keywordtype">int</span> i = 1;
00797         ChromIter ch;
00798         vector&lt;GENE&gt; chromo;
00799         <span class="keywordflow">for</span> (PopConstIter iter = population.begin(); iter != population.end(); ++iter, ++i) {
00800             out &lt;&lt; setw(3) &lt;&lt; i &lt;&lt; <span class="stringliteral">": "</span>;
00801             chromo = (*iter)-&gt;GetGenotype();
00802             <span class="keywordflow">for</span> (ch = chromo.begin(); ch != chromo.end(); ++ ch) {
00803                 out &lt;&lt; setw(2) &lt;&lt; *ch &lt;&lt; <span class="stringliteral">" "</span>;
00804             }
00805             out &lt;&lt; <span class="stringliteral">" Fitness: "</span> &lt;&lt; setw(6) &lt;&lt; (*iter)-&gt;GetFitness() &lt;&lt; endl;
00806         }
00807         out &lt;&lt; endl;
00808     }
00809 
00810     <span class="keywordflow">if</span> ((printStyle &amp; <a class="code" href="group__biosystems.html#a16a44">GA_HISTORY</a>) != 0) {
00811         out &lt;&lt; <span class="stringliteral">"  Gen   |   Avg   |  Best"</span> &lt;&lt; endl;
00812         vector&lt;float&gt;::const_iterator avgIter = averageFitnessRecord.begin();
00813         vector&lt;float&gt;::const_iterator bestIter = bestFitnessRecord.begin();
00814         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; avgIter != averageFitnessRecord.end();
00815         ++i, ++avgIter, ++bestIter) {
00816             out &lt;&lt; setw(8) &lt;&lt; i &lt;&lt; <span class="stringliteral">"  "</span>
00817                 &lt;&lt; setw(8) &lt;&lt; *avgIter &lt;&lt; <span class="stringliteral">"  "</span>
00818                 &lt;&lt; setw(8) &lt;&lt; *bestIter
00819                 &lt;&lt; endl;
00820         }
00821     }
00822 
00823     <span class="keywordflow">return</span> out.str();
00824 }
00825 
00831 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
<a name="l00832"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a36">00832</a> std::string <a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::GetCSV</a>(<span class="keywordtype">char</span> separator)<span class="keyword">const</span>
00833 {
00834     <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00835 
00836     ostringstream out;
00837 
00838     vector&lt;float&gt;::const_iterator avgIter = averageFitnessRecord.begin();
00839     vector&lt;float&gt;::const_iterator bestIter = bestFitnessRecord.begin();
00840 
00841     out &lt;&lt; <span class="stringliteral">"Average fitness"</span> &lt;&lt; separator &lt;&lt; <span class="stringliteral">"Best fitness"</span> &lt;&lt; endl;
00842 
00843     <span class="keywordflow">for</span> (; avgIter != averageFitnessRecord.end(); ++avgIter, ++bestIter) {
00844         out &lt;&lt; *avgIter &lt;&lt; separator &lt;&lt; *bestIter &lt;&lt; endl;
00845     }
00846 
00847     <span class="keywordflow">return</span> out.str();
00848 }
00849 
00855 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
<a name="l00856"></a><a class="code" href="classBEAST_1_1GeneticAlgorithm.html#a37">00856</a> <span class="keywordtype">void</span> <a class="code" href="classBEAST_1_1GeneticAlgorithm.html">GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::CleanUp</a>()
00857 {
00858     <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00859     for_each(population.begin(), population.end(), <a class="code" href="structBEAST_1_1deleter.html">deleter&lt;EVO&gt;</a>());
00860     for_each(outputPopulation.begin(), outputPopulation.end(), <a class="code" href="structBEAST_1_1deleter.html">deleter&lt;EVO&gt;</a>());
00861 }
00862 
00863 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
00864 <span class="keywordtype">void</span> GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::Serialise(std::ostream&amp; out)<span class="keyword">const</span>
00865 {
00866     std::string name = <a class="code" href="namespaceBEAST.html#a96">add_slashes</a>(std::string(<span class="stringliteral">"GeneticAlgorithm_"</span>)
00867                                    + <span class="keyword">typeid</span>(EVO).name());
00868 
00869     out &lt;&lt; name &lt;&lt; <span class="stringliteral">"\n"</span>
00870         &lt;&lt; crossover &lt;&lt; <span class="stringliteral">"\n"</span>
00871         &lt;&lt; mutation &lt;&lt; <span class="stringliteral">"\n"</span>
00872         &lt;&lt; selection &lt;&lt; <span class="stringliteral">"\n"</span>
00873         &lt;&lt; outputPopSize &lt;&lt; <span class="stringliteral">"\n"</span>
00874         &lt;&lt; elitism &lt;&lt; <span class="stringliteral">"\n"</span>
00875         &lt;&lt; subelitism &lt;&lt; <span class="stringliteral">"\n"</span>
00876         &lt;&lt; crossoverPoints &lt;&lt; <span class="stringliteral">"\n"</span>
00877         &lt;&lt; fitnessMethod &lt;&lt; <span class="stringliteral">"\n"</span>
00878         &lt;&lt; fitnessFix &lt;&lt; <span class="stringliteral">"\n"</span>
00879         &lt;&lt; fltParams
00880         &lt;&lt; intParams
00881         &lt;&lt; (ownsData ? <span class="stringliteral">"ownsdata"</span> : <span class="stringliteral">"not-ownsdata"</span>) &lt;&lt; <span class="stringliteral">"\n"</span>
00882         &lt;&lt; printStyle &lt;&lt; <span class="stringliteral">"\n"</span>
00883         &lt;&lt; generations &lt;&lt; <span class="stringliteral">"\n"</span>
00884         &lt;&lt; averageFitnessRecord
00885         &lt;&lt; bestFitnessRecord
00886         &lt;&lt; bestEverFitness &lt;&lt; <span class="stringliteral">"\n"</span>
00887         &lt;&lt; bestEverGenome
00888         &lt;&lt; bestCurrentGenome;
00889 }
00890 
00891 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
00892 <span class="keywordtype">void</span> GeneticAlgorithm&lt;EVO, MUTFUNC&gt;::Unserialise(std::istream&amp; in)
00893 {
00894     std::string name, expName = <a class="code" href="namespaceBEAST.html#a96">add_slashes</a>(std::string(<span class="stringliteral">"GeneticAlgorithm_"</span>)
00895                                             + <span class="keyword">typeid</span>(EVO).name());
00896     in &gt;&gt; name;
00897     <span class="keywordflow">if</span> (name != expName) {
00898         <span class="keywordflow">throw</span> SerialException(SERIAL_ERROR_WRONG_TYPE, <a class="code" href="namespaceBEAST.html#a97">strip_slashes</a>(name),
00899                               <span class="stringliteral">"This object is type "</span> + <a class="code" href="namespaceBEAST.html#a97">strip_slashes</a>(expName));
00900     }
00901 
00902     in &gt;&gt; crossover
00903        &gt;&gt; mutation
00904        &gt;&gt; selection
00905        &gt;&gt; outputPopSize
00906        &gt;&gt; elitism
00907        &gt;&gt; subelitism
00908        &gt;&gt; crossoverPoints
00909        &gt;&gt; fitnessMethod
00910        &gt;&gt; fitnessFix
00911        &gt;&gt; fltParams
00912        &gt;&gt; intParams
00913        &gt;&gt; switcher(<span class="stringliteral">"ownsdata"</span>, ownsData)
00914        &gt;&gt; printStyle
00915        &gt;&gt; generations
00916        &gt;&gt; averageFitnessRecord
00917        &gt;&gt; bestFitnessRecord
00918        &gt;&gt; bestEverFitness
00919        &gt;&gt; bestEverGenome
00920        &gt;&gt; bestCurrentGenome;
00921 }
00922 
00923 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
00924 std::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, const GeneticAlgorithm&lt;EVO, MUTFUNC&gt;&amp; ga)
00925 {
00926     ga.Serialise(out);
00927     <span class="keywordflow">return</span> out;
00928 }
00929 
00930 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EVO, <span class="keyword">class</span> MUTFUNC&gt;
00931 std::istream&amp; <a class="code" href="group__biosystems.html#a3">operator&gt;&gt;</a>(std::istream&amp; in, GeneticAlgorithm&lt;EVO, MUTFUNC&gt;&amp; ga)
00932 {
00933     ga.Unserialise(in);
00934     <span class="keywordflow">return</span> in;
00935 }
00936 
00937 <a class="code" href="group__serialisation.html#a13">IMPLEMENT_IOSTREAM_CAST</a>(GASelectionType, <span class="keywordtype">int</span>)
00938 <a class="code" href="group__serialisation.html#a13">IMPLEMENT_IOSTREAM_CAST</a>(GAFltParamType, <span class="keywordtype">int</span>)
00939 <a class="code" href="group__serialisation.html#a13">IMPLEMENT_IOSTREAM_CAST</a>(GAIntParamType, <span class="keywordtype">int</span>)
00940 <a class="code" href="group__serialisation.html#a13">IMPLEMENT_IOSTREAM_CAST</a>(GAPrintStyleType, <span class="keywordtype">int</span>)
00941 <a class="code" href="group__serialisation.html#a13">IMPLEMENT_IOSTREAM_CAST</a>(GAFitnessMethodType, <span class="keywordtype">int</span>)
00942 <a class="code" href="group__serialisation.html#a13">IMPLEMENT_IOSTREAM_CAST</a>(GAFitnessFixType, <span class="keywordtype">int</span>)
00943 
00944 
00951 <span class="keyword">template</span> &lt;&gt;
<a name="l00952"></a><a class="code" href="structBEAST_1_1MutationOperator_3_01bool_01_4.html">00952</a> <span class="keyword">struct </span><a class="code" href="structBEAST_1_1MutationOperator.html">MutationOperator</a>&lt;bool&gt;
00953 {
00954     <a class="code" href="structBEAST_1_1MutationOperator.html#a0">MutationOperator</a>(){}
00955     <a class="code" href="structBEAST_1_1MutationOperator.html#a0">MutationOperator</a>(<span class="keywordtype">bool</span>, <span class="keywordtype">bool</span>){}
00956     <span class="keywordtype">bool</span> <a class="code" href="structBEAST_1_1MutationOperator.html#a1">operator()</a>(<span class="keywordtype">bool</span> b) { <span class="keywordflow">return</span> !b; }
00957 };
00958 
<a name="l00963"></a><a class="code" href="group__biosystems.html#a19">00963</a> <span class="keyword">enum</span> <a class="code" href="group__biosystems.html#a19">GAVariantType</a> {
00964     GAV_INT,
00965     GAV_FLOAT,
00966     GAV_DOUBLE,
00967     GAV_CHAR,
00968     GAV_BOOL
00969 };
00970 
<a name="l00977"></a><a class="code" href="structBEAST_1_1GAVariant.html">00977</a> <span class="keyword">struct </span><a class="code" href="structBEAST_1_1GAVariant.html">GAVariant</a>
00978 {
<a name="l00980"></a><a class="code" href="structBEAST_1_1GAVariant.html#a0">00980</a>     <a class="code" href="structBEAST_1_1GAVariant.html#a0">GAVariant</a>(<span class="keywordtype">int</span> v = 0):   <a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>(v),<a class="code" href="structBEAST_1_1GAVariant.html#o1">type</a>(GAV_INT){}
<a name="l00982"></a><a class="code" href="structBEAST_1_1GAVariant.html#a1">00982</a>     <a class="code" href="structBEAST_1_1GAVariant.html#a0">GAVariant</a>(<span class="keywordtype">float</span> v): <a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>(v),<a class="code" href="structBEAST_1_1GAVariant.html#o1">type</a>(GAV_FLOAT){}
<a name="l00984"></a><a class="code" href="structBEAST_1_1GAVariant.html#a2">00984</a>     <a class="code" href="structBEAST_1_1GAVariant.html#a0">GAVariant</a>(<span class="keywordtype">double</span> v):<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>(v),<a class="code" href="structBEAST_1_1GAVariant.html#o1">type</a>(GAV_DOUBLE){}
<a name="l00986"></a><a class="code" href="structBEAST_1_1GAVariant.html#a3">00986</a>     <a class="code" href="structBEAST_1_1GAVariant.html#a0">GAVariant</a>(<span class="keywordtype">char</span> v):  <a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>(v),<a class="code" href="structBEAST_1_1GAVariant.html#o1">type</a>(GAV_CHAR){}
<a name="l00988"></a><a class="code" href="structBEAST_1_1GAVariant.html#a4">00988</a>     <a class="code" href="structBEAST_1_1GAVariant.html#a0">GAVariant</a>(<span class="keywordtype">bool</span> v):  <a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>(v),<a class="code" href="structBEAST_1_1GAVariant.html#o1">type</a>(GAV_BOOL){}
00989 
<a name="l00991"></a><a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html">00991</a>     <span class="keyword">union </span><a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html">VariantData</a> {
00992         <a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html">VariantData</a>(<span class="keywordtype">int</span> v):i(v){}
00993         <a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html">VariantData</a>(<span class="keywordtype">float</span> v):f(v){}
00994         <a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html">VariantData</a>(<span class="keywordtype">double</span> v):d(v){}
00995         <a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html">VariantData</a>(<span class="keywordtype">char</span> v):c(v){}
00996         <a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html">VariantData</a>(<span class="keywordtype">bool</span> v):b(v){}
00997 
00998         <span class="keywordtype">int</span>     i;
00999         <span class="keywordtype">float</span>   f;
01000         <span class="keywordtype">double</span>  d;
01001         <span class="keywordtype">char</span>    c;
01002         <span class="keywordtype">bool</span>    b;
01003     } <a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>;
01004 
<a name="l01006"></a><a class="code" href="structBEAST_1_1GAVariant.html#o1">01006</a>     <a class="code" href="group__biosystems.html#a19">GAVariantType</a> <a class="code" href="structBEAST_1_1GAVariant.html#o1">type</a>;
01007 
<a name="l01009"></a><a class="code" href="structBEAST_1_1GAVariant.html#a5">01009</a>     <a class="code" href="structBEAST_1_1GAVariant.html#a5">operator int</a>()<span class="keyword">const</span>
01010     {
01011         <span class="keywordflow">switch</span> (<a class="code" href="structBEAST_1_1GAVariant.html#o1">type</a>) {
01012         <span class="keywordflow">case</span> GAV_INT: <span class="keywordflow">return</span> <a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o0">i</a>;
01013         <span class="keywordflow">case</span> GAV_FLOAT: <span class="keywordflow">return</span> static_cast&lt;int&gt;(<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o1">f</a>);
01014         <span class="keywordflow">case</span> GAV_DOUBLE: <span class="keywordflow">return</span> static_cast&lt;int&gt;(<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o2">d</a>);
01015         <span class="keywordflow">case</span> GAV_CHAR: <span class="keywordflow">return</span> static_cast&lt;int&gt;(<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o3">c</a>);
01016         <span class="keywordflow">case</span> GAV_BOOL: <span class="keywordflow">return</span> static_cast&lt;int&gt;(<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o4">b</a>);
01017         }
01018         <span class="keywordflow">return</span> 0;
01019     }
01020 
<a name="l01022"></a><a class="code" href="structBEAST_1_1GAVariant.html#a6">01022</a>     <a class="code" href="structBEAST_1_1GAVariant.html#a6">operator float</a>()<span class="keyword">const</span>
01023     {
01024         <span class="keywordflow">switch</span> (<a class="code" href="structBEAST_1_1GAVariant.html#o1">type</a>) {
01025         <span class="keywordflow">case</span> GAV_INT: <span class="keywordflow">return</span> static_cast&lt;float&gt;(<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o0">i</a>);
01026         <span class="keywordflow">case</span> GAV_FLOAT: <span class="keywordflow">return</span> <a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o1">f</a>;
01027         <span class="keywordflow">case</span> GAV_DOUBLE: <span class="keywordflow">return</span> static_cast&lt;float&gt;(<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o2">d</a>);
01028         <span class="keywordflow">case</span> GAV_CHAR: <span class="keywordflow">return</span> static_cast&lt;float&gt;(<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o3">c</a>);
01029         <span class="keywordflow">case</span> GAV_BOOL: <span class="keywordflow">return</span> static_cast&lt;float&gt;(<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o4">b</a>);
01030         }
01031         <span class="keywordflow">return</span> 0.0f;
01032     }
01033 
<a name="l01035"></a><a class="code" href="structBEAST_1_1GAVariant.html#a7">01035</a>     <a class="code" href="structBEAST_1_1GAVariant.html#a7">operator double</a>()<span class="keyword">const</span>
01036     {
01037         <span class="keywordflow">switch</span> (<a class="code" href="structBEAST_1_1GAVariant.html#o1">type</a>) {
01038         <span class="keywordflow">case</span> GAV_INT: <span class="keywordflow">return</span> static_cast&lt;double&gt;(<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o0">i</a>);
01039         <span class="keywordflow">case</span> GAV_FLOAT: <span class="keywordflow">return</span> static_cast&lt;double&gt;(<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o1">f</a>);
01040         <span class="keywordflow">case</span> GAV_DOUBLE: <span class="keywordflow">return</span> <a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o2">d</a>;
01041         <span class="keywordflow">case</span> GAV_CHAR: <span class="keywordflow">return</span> static_cast&lt;double&gt;(<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o3">c</a>);
01042         <span class="keywordflow">case</span> GAV_BOOL: <span class="keywordflow">return</span> static_cast&lt;double&gt;(<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o4">b</a>);
01043         }
01044         <span class="keywordflow">return</span> 0.0;
01045     }
01046 
<a name="l01048"></a><a class="code" href="structBEAST_1_1GAVariant.html#a8">01048</a>     <a class="code" href="structBEAST_1_1GAVariant.html#a8">operator char</a>()<span class="keyword">const</span>
01049     {
01050         <span class="keywordflow">switch</span> (<a class="code" href="structBEAST_1_1GAVariant.html#o1">type</a>) {
01051         <span class="keywordflow">case</span> GAV_INT: <span class="keywordflow">return</span> static_cast&lt;char&gt;(<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o0">i</a>);
01052         <span class="keywordflow">case</span> GAV_FLOAT: <span class="keywordflow">return</span> static_cast&lt;char&gt;(<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o1">f</a>);
01053         <span class="keywordflow">case</span> GAV_DOUBLE: <span class="keywordflow">return</span> static_cast&lt;char&gt;(<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o2">d</a>);
01054         <span class="keywordflow">case</span> GAV_CHAR: <span class="keywordflow">return</span> <a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o3">c</a>;
01055         <span class="keywordflow">case</span> GAV_BOOL: <span class="keywordflow">return</span> static_cast&lt;char&gt;(<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o4">b</a>);
01056         }
01057         <span class="keywordflow">return</span> <span class="charliteral">'\0'</span>;
01058     }
01059 
<a name="l01061"></a><a class="code" href="structBEAST_1_1GAVariant.html#a9">01061</a>     <a class="code" href="structBEAST_1_1GAVariant.html#a9">operator bool</a>()<span class="keyword">const</span>
01062     {
01063         <span class="keywordflow">switch</span> (<a class="code" href="structBEAST_1_1GAVariant.html#o1">type</a>) {
01064         <span class="keywordflow">case</span> GAV_INT: <span class="keywordflow">return</span> <a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o0">i</a> != 0;
01065         <span class="keywordflow">case</span> GAV_FLOAT: <span class="keywordflow">return</span> <a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o1">f</a> != 0.0f;
01066         <span class="keywordflow">case</span> GAV_DOUBLE: <span class="keywordflow">return</span> <a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o2">d</a> != 0.0;
01067         <span class="keywordflow">case</span> GAV_CHAR: <span class="keywordflow">return</span> <a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o3">c</a> != 0;
01068         <span class="keywordflow">case</span> GAV_BOOL: <span class="keywordflow">return</span> <a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o4">b</a>;
01069         }
01070         <span class="keywordflow">return</span> <span class="keyword">false</span>;
01071     }
01072 };
01073 
01074 <span class="keyword">inline</span> std::ostream&amp; <a class="code" href="group__biosystems.html#a2">operator&lt;&lt;</a>(std::ostream&amp; out, <span class="keyword">const</span> GAVariant&amp; v)
01075 {
01076     out &lt;&lt; <span class="stringliteral">"GAVariant\n"</span>;
01077     <span class="keywordflow">switch</span> (v.type) {
01078     <span class="keywordflow">case</span> GAV_INT: <span class="keywordflow">return</span> out &lt;&lt; <span class="stringliteral">"int "</span> &lt;&lt; v.value.i &lt;&lt; <span class="stringliteral">"\n"</span>;
01079     <span class="keywordflow">case</span> GAV_FLOAT: <span class="keywordflow">return</span> out &lt;&lt; <span class="stringliteral">"float "</span> &lt;&lt; v.value.f &lt;&lt; <span class="stringliteral">"\n"</span>;
01080     <span class="keywordflow">case</span> GAV_DOUBLE: <span class="keywordflow">return</span> out &lt;&lt; <span class="stringliteral">"double "</span> &lt;&lt; v.value.d &lt;&lt; <span class="stringliteral">"\n"</span>;
01081     <span class="keywordflow">case</span> GAV_CHAR: <span class="keywordflow">return</span> out &lt;&lt; <span class="stringliteral">"char "</span> &lt;&lt; v.value.c &lt;&lt; <span class="stringliteral">"\n"</span>;
01082     <span class="keywordflow">case</span> GAV_BOOL: <span class="keywordflow">return</span> out &lt;&lt; <span class="stringliteral">"bool "</span> &lt;&lt; v.value.b &lt;&lt; <span class="stringliteral">"\n"</span>;
01083     }
01084     <span class="keywordflow">return</span> out;
01085 }
01086 
01087 <span class="keyword">inline</span> std::istream&amp; <a class="code" href="group__biosystems.html#a3">operator&gt;&gt;</a>(std::istream&amp; in, GAVariant&amp; v)
01088 {
01089     std::string name;
01090     in &gt;&gt; name;
01091     <span class="keywordflow">if</span> (name != <span class="stringliteral">"GAVariant"</span>) {
01092         <span class="keywordflow">throw</span> SerialException(SERIAL_ERROR_DATA_MISMATCH, <span class="stringliteral">""</span>,
01093                               <span class="stringliteral">"Expected GAVariant but got "</span> + name);
01094     }
01095 
01096     std::string type;
01097     in &gt;&gt; type;
01098     <span class="keywordflow">if</span> (type == <span class="stringliteral">"int"</span>) { v.type = GAV_INT;  <span class="keywordflow">return</span> in &gt;&gt; v.value.i; }
01099     <span class="keywordflow">if</span> (type == <span class="stringliteral">"float"</span>) { v.type = GAV_FLOAT;  <span class="keywordflow">return</span> in &gt;&gt; v.value.f; }
01100     <span class="keywordflow">if</span> (type == <span class="stringliteral">"double"</span>) { v.type = GAV_DOUBLE;  <span class="keywordflow">return</span> in &gt;&gt; v.value.d; }
01101     <span class="keywordflow">if</span> (type == <span class="stringliteral">"char"</span>) { v.type = GAV_CHAR;  <span class="keywordflow">return</span> in &gt;&gt; v.value.c; }
01102     <span class="keywordflow">if</span> (type == <span class="stringliteral">"bool"</span>) { v.type = GAV_BOOL;  <span class="keywordflow">return</span> in &gt;&gt; v.value.b; }
01103 
01104     <span class="keywordflow">return</span> in;
01105 }
01106 
01116 <span class="keyword">template</span> &lt;&gt;
<a name="l01117"></a><a class="code" href="structBEAST_1_1MutationOperator_3_01GAVariant_01_4.html">01117</a> <span class="keyword">struct </span><a class="code" href="structBEAST_1_1MutationOperator.html">MutationOperator</a>&lt;GAVariant&gt;
01118 {
<a name="l01120"></a><a class="code" href="structBEAST_1_1MutationOperator_3_01GAVariant_01_4.html#a0">01120</a>     <a class="code" href="structBEAST_1_1MutationOperator.html#a0">MutationOperator</a>(GAVariant min = -1.0, GAVariant max = 1.0):
01121     intMutator(static_cast&lt;int&gt;(min), static_cast&lt;int&gt;(max)),
01122     floatMutator(static_cast&lt;float&gt;(min), static_cast&lt;float&gt;(max)),
01123     doubleMutator(static_cast&lt;double&gt;(min), static_cast&lt;double&gt;(max)),
01124     charMutator(static_cast&lt;char&gt;(min), static_cast&lt;char&gt;(max)),
01125     boolMutator(static_cast&lt;bool&gt;(min), static_cast&lt;bool&gt;(max))
01126     {}
01127 
<a name="l01129"></a><a class="code" href="structBEAST_1_1MutationOperator_3_01GAVariant_01_4.html#a1">01129</a>     GAVariant <a class="code" href="structBEAST_1_1MutationOperator.html#a1">operator()</a>(GAVariant in)
01130     {
01131         <span class="keywordflow">switch</span> (in.<a class="code" href="structBEAST_1_1GAVariant.html#o1">type</a>) {
01132         <span class="keywordflow">case</span> GAV_INT: <span class="keywordflow">return</span> intMutator(in.<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o0">i</a>);
01133         <span class="keywordflow">case</span> GAV_FLOAT: <span class="keywordflow">return</span> floatMutator(in.<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o1">f</a>);
01134         <span class="keywordflow">case</span> GAV_DOUBLE: <span class="keywordflow">return</span> doubleMutator(in.<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o2">d</a>);
01135         <span class="keywordflow">case</span> GAV_CHAR: <span class="keywordflow">return</span> charMutator(in.<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o3">c</a>);
01136         <span class="keywordflow">case</span> GAV_BOOL: <span class="keywordflow">return</span> boolMutator(in.<a class="code" href="structBEAST_1_1GAVariant.html#o0">value</a>.<a class="code" href="unionBEAST_1_1GAVariant_1_1VariantData.html#o4">b</a>);
01137         }
01138         <span class="keywordflow">return</span> GAVariant();
01139     }
01140 
<a name="l01141"></a><a class="code" href="structBEAST_1_1MutationOperator_3_01GAVariant_01_4.html#o0">01141</a>     <a class="code" href="structBEAST_1_1MutationOperator.html">MutationOperator&lt;int&gt;</a>       intMutator;     
<a name="l01142"></a><a class="code" href="structBEAST_1_1MutationOperator_3_01GAVariant_01_4.html#o1">01142</a>     <a class="code" href="structBEAST_1_1MutationOperator.html">MutationOperator&lt;float&gt;</a>     floatMutator;   
<a name="l01143"></a><a class="code" href="structBEAST_1_1MutationOperator_3_01GAVariant_01_4.html#o2">01143</a>     <a class="code" href="structBEAST_1_1MutationOperator.html">MutationOperator&lt;double&gt;</a>    doubleMutator;  
<a name="l01144"></a><a class="code" href="structBEAST_1_1MutationOperator_3_01GAVariant_01_4.html#o3">01144</a>     <a class="code" href="structBEAST_1_1MutationOperator.html">MutationOperator&lt;char&gt;</a>      charMutator;    
<a name="l01145"></a><a class="code" href="structBEAST_1_1MutationOperator_3_01GAVariant_01_4.html#o4">01145</a>     <a class="code" href="structBEAST_1_1MutationOperator.html">MutationOperator&lt;bool&gt;</a>      boolMutator;    
01146 };
01147 
01152 } <span class="comment">// namespace BEAST</span>
01153 
01154 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sun Feb 1 21:25:34 2004 for BEAST - Bioinspired Evolutionary Agent Simulation Toolkit by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.2 </small></address>
</body>
</html>
